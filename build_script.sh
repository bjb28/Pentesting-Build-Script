#!/bin/bash

#Update Kali before starting
echo -e  '\e[1;34m'"{::Starting Kali update before installs::}"'\e[0m'
sudo apt update && sudo apt-get -y upgrade && sudo apt-get -y dist-upgrade && sudo apt-get -y autoclean && sudo apt-get -y autoremove

#Build Tools Directories (both in root and OPT depending on user preference)
echo -e  '\e[1;34m'"{::Creating linked Tool directories ~/Tools and /OPT/Tools::}"'\e[0m'
mkdir -p /root/Tools
mkdir -p /opt/Tools
ln -s /root/Tools /opt/Tools

#Install Sublime Text Editor
echo -e  '\e[1;34m'"{::Installing Sublime Text Editor::}"'\e[0m'
wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | sudo apt-key add -
sudo apt-get -y install apt-transport-https
echo -e  "deb https://download.sublimetext.com/ apt/stable/" | sudo tee /etc/apt/sources.list.d/sublime-text.list
sudo apt-get -y update && sudo apt  -y install sublime-text

#Install Terminator
echo -e  '\e[1;34m'"{::Installing Terminator::}"'\e[0m'
apt-get -y install terminator

# Git Clones of Tools
echo -e  '\e[1;34m'"{::Performing GIT clones of tools from GitHub::}"'\e[0m'
cd /root/Tools
git clone https://github.com/Tib3rius/AutoRecon.git
git clone https://github.com/samratashok/nishang.git
git clone https://github.com/3ndG4me/AutoBlue-MS17-010.git
git clone https://github.com/BC-SECURITY/Empire.git
git clone https://github.com/PowerShellMafia/PowerSploit.git
git clone https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite.git
git clone https://github.com/rasta-mouse/Sherlock.git
git clone https://github.com/rasta-mouse/Watson.git
git clone https://github.com/sleventyeleven/linuxprivchecker.git
git clone https://github.com/rebootuser/LinEnum.git
git clone https://github.com/411Hall/JAWS.git
git clone https://github.com/SecureAuthCorp/impacket.git
git clone https://github.com/vulnersCom/nmap-vulners
git clone https://github.com/swisskyrepo/PayloadsAllTheThings.git
git clone https://github.com/BloodHoundAD/BloodHound.git
git clone https://github.com/ropnop/kerbrute.git
git clone https://github.com/rebootuser/LinEnum.git
git clone https://github.com/AonCyberLabs/Windows-Exploit-Suggester.git
git clone https://github.com/maurosoria/dirsearch.git
git clone https://github.com/D35m0nd142/LFISuite.git

# To Add (temp)
#snmpwalk svwar wkhtmltoimage  

# Apt dependency installs
echo -e  '\e[1;34m'"{::Installing tools/dependencies avaliable with APT::}"'\e[0m'
echo -e  '\e[1;34m'"{:seclists curl bloodhound enum4linux gobuster nbtscan nikto:]\e[0m" 
echo -e  '\e[1;34m'"{:nmap onesixtyone oscanner smbclient smbmap smtp-user-enum sslscan tnscmd10g whatweb:]\e[0m"
sudo apt-get -y install seclists curl bloodhound enum4linux gobuster nbtscan nikto nmap onesixtyone oscanner smbclient smbmap smtp-user-enum sslscan tnscmd10g whatweb


# AutoRecon Specific install
echo -e  '\e[1;34m'"{::Installing AutoRecon python dependencies::}"'\e[0m'
pip install -r /root/Tools/AutoRecon/requirements.txt

# Installing Empire V3
echo -e  '\e[1;34m'"{::Installing Empire V3::}"'\e[0m'
pushd /root/Tools/Empire
echo -e  "password" | bash "./setup/install.sh"
popd

# Installing Evil-WinRM
echo -e  '\e[1;34m'"{::Installing Evil-WinRM::}"'\e[0m'
gem install evil-winrm

# Installing Impacket (updated version)
echo -e  '\e[1;34m'"{::Installing Impacket::}"'\e[0m'
pip3 install argparse pyasn1 pycryptodomex pyOpenSSL ldapdomaindump flask ldap3 tox
pip3 install /root/Tools/impacket

# Extracting Bloodhound
echo -e  '\e[1;34m'"{::Extracting Bloodhound Ingestors::}"'\e[0m'
pushd /root/Tools/BloodHound/
rm *.*
mv ./Ingestors/*.* ./
rm -rf Ingestors src BloodHoundExampleDB.graphdb
popd

# Install Veil Evasion
echo -e  '\e[1;34m'"{::Installing Veil 3.0::}"'\e[0m'
apt -y install veil
/usr/share/veil/config/setup.sh --force --silent

# Install Nmap Vulners script
echo -e  '\e[1;34m'"{::Copying Vulners.nse to Nmap Scripts directory and update db::}"'\e[0m'
cp /root/Tools/nmap-vulners/vulners.nse /usr/share/nmap/scripts
nmap --script-updatedb

#Extract Rockyou
echo -e  '\e[1;34m'"{::Extracting Rockyou::}"'\e[0m'
gzip -d /usr/share/wordlists/rockyou.txt.gz

# Update WPScan and Searchsploit
echo -e  '\e[1;34m'"{::Updating WPScan::}"'\e[0m'
wpscan --update
echo -e  '\e[1;34m'"{::Updating Searchsploit::}"'\e[0m'
searchsploit --update
